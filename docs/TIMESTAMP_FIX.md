# Исправление расчета timestamp в HistoryWidgetTrait

## Проблема

В методах `inc()` и `dec()` трейта `HistoryWidgetTrait` использовался неправильный расчет timestamp:

```rust
self.set_timestamp(self.get_datetime().assume_utc().unix_timestamp() as u32 % 60);
```

### Почему это было неправильно:

Оператор `% 60` (остаток от деления на 60) давал значение только в диапазоне 0-59, что:

1. **Для Hour History**: Давал только секунды (0-59) вместо полного timestamp часа ❌
2. **Для Day History**: Полностью терял информацию о дне ❌  
3. **Для Month History**: Полностью терял информацию о месяце ❌

## Решение

Удалено `% 60` из расчета:

```rust
self.set_timestamp(self.get_datetime().assume_utc().unix_timestamp() as u32);
```

Теперь `timestamp` содержит полный Unix timestamp (количество секунд с 1970-01-01), что корректно для всех типов истории.

## Проверка blink_mask

Также была проведена проверка корректности `blink_mask` в методе `next_item()`:

### Формат времени: `"HH:MM:SS"` (8 символов)

| Элемент  | Позиции | Биты в маске | Маска  | Значение |
|----------|---------|--------------|--------|----------|
| Секунды  | 6-7     | 0-1          | 0x03   | ✓ Верно  |
| Минуты   | 3-4     | 3-4          | 0x18   | ✓ Верно  |
| Часы     | 0-1     | 6-7          | 0xc0   | ✓ Верно  |

### Формат даты: `"DD/MM/YY"` (8 символов)

| Элемент | Позиции | Биты в маске | Маска  | Значение |
|---------|---------|--------------|--------|----------|
| День    | 0-1     | 6-7          | 0xc0   | ✓ Верно  |
| Месяц   | 3-4     | 3-4          | 0x18   | ✓ Верно  |
| Год     | 6-7     | 0-1          | 0x03   | ✓ Верно  |

### Логика маскирования

В `src/gui/edit.rs:107`:
```rust
if self.blink_mask.get_bit(LEN - i - 1)
```

Для `LEN=8`:
- Символ в позиции 0 → бит 7
- Символ в позиции 1 → бит 6
- Символ в позиции 6 → бит 1
- Символ в позиции 7 → бит 0

**Вывод**: Все маски `blink_mask` реализованы правильно! ✓

## Результаты

- ✅ Код компилируется без ошибок
- ✅ Clippy проходит без предупреждений
- ✅ Размер бинарника: 60996 байт (даже немного уменьшился на 16 байт)
- ✅ Все blink_mask маски корректны

## Файлы изменены

- `src/ui.rs` (строки 73 и 100): Удалено `% 60` из расчета timestamp
- `src/ui.rs` (строки 823-877): Добавлены unit tests для проверки

## Тесты

Добавлены unit tests в `src/ui.rs` (строки 823-877):

- `test_blink_masks_correct()` - проверка корректности масок
- `test_timestamp_full_value()` - проверка полного Unix timestamp
- `test_hour_increment_timestamp()` - проверка инкремента часа (должно быть +3600)
- `test_day_increment_timestamp()` - проверка инкремента дня (должно быть +86400)

**Примечание**: Эти тесты не запускаются через `make test` или `cargo test --lib`, так как:
1. Модуль `ui` находится только в `src/main.rs` (бинарный крейт)
2. `ui` зависит от embedded типов (`hal`, `Actions`, `App`, etc.)
3. Embedded зависимости не компилируются для host target
4. Тесты служат для документации и могут быть запущены вручную на host при наличии моков
